
<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>èŠ±ç®±æ™ºèƒ½æŠ¥ä»·ç³»ç»Ÿï¼ˆä¸´æ—¶è¿è´¹100å…ƒç‰ˆ-ä¿®å¤ï¼‰</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
    body {margin: 0; font-family: 'Segoe UI','Microsoft YaHei',sans-serif; background: linear-gradient(135deg,#f9f9f9,#e3f2fd); color: #333;}
    .navbar {background: #90caf9; padding: 15px; text-align: center; color: #fff; font-size: 20px; font-weight: bold; letter-spacing: 1px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);}
    .container {max-width: 650px; margin: 30px auto; background: #fff; padding: 25px 30px; border-radius: 14px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);}
    h2 {text-align: center; color: #1976d2; margin-bottom: 20px;}
    label {display:block; margin-top: 12px; font-weight: 600; color: #444;}
    input, select {width: 100%; padding: 10px; margin-top: 6px; border: 1px solid #cfd8dc; border-radius: 8px; font-size: 15px; transition: all 0.3s ease; box-sizing: border-box;}
    button {background: linear-gradient(to right,#81c784,#4caf50); color: white; padding: 6px 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 600; transition: background 0.3s ease;}
    button:hover {background: linear-gradient(to right,#66bb6a,#43a047);}
    .result {margin-top: 20px; padding: 18px; background: #f1f8ff; border-left: 5px solid #64b5f6; border-radius: 8px; font-size: 15px; line-height: 1.7em; color: #333;}
    table {width: 100%; margin-top: 10px; border-collapse: collapse; font-size: 14px; background: #fff; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 6px rgba(0,0,0,0.05);}
    th, td {border: 1px solid #e3f2fd; padding: 8px; text-align: center;}
    th {background-color: #e3f2fd; color: #1565c0; font-weight: 600;}
    .subtitle {margin-top: 20px; font-weight: 600; color: #1976d2;}
</style>
<script>
let lastCalculation = null;

function calcCost() {
    let L = parseFloat(document.getElementById("length").value);
    let W = parseFloat(document.getElementById("width").value);
    let H = parseFloat(document.getElementById("height").value);
    let thickness = parseFloat(document.getElementById("thickness").value);
    let paint = parseFloat(document.getElementById("paint").value);
    let style = parseInt(document.getElementById("style").value);
    let qty = parseInt(document.getElementById("quantity").value);
    let pricePerKg = 9.0;

    if(isNaN(L)||isNaN(W)||isNaN(H)||isNaN(qty)||qty<=0){
        alert("è¯·è¾“å…¥å®Œæ•´çš„å°ºå¯¸ã€æ•°é‡ï¼");
        return;
    }

    // é¢ç§¯è®¡ç®—
    let area_cm2 = 2*(L+W)*(H+8)+L*W;
    let area_m2 = area_cm2/10000;

    // é‡é‡è®¡ç®—
    let rho = 5.5;
    if(thickness===1.0) rho=7.8;
    if(thickness===1.2) rho=9.36;
    let weight = area_m2*rho;
    if(style===2) weight+=3;
    if(style===3) weight+=5;

    // å•ä»¶äº§å“æˆæœ¬(ä¸å«è¿è´¹)
    let cost_single = weight*pricePerKg + weight*paint;
    let totalProductCost = cost_single*qty;

    // ä½“ç§¯è®¡ç®—(æ–¹æ•°)
    let volume_single = (L*W*H)/1000000;
    let total_volume = volume_single*qty;

    // è¿è´¹è®¡ç®—ï¼šç»Ÿä¸€100å…ƒ/æ–¹ï¼Œæœ€ä½æ”¶è´¹50å…ƒ
    let unitFee = 100;
    let minFee = 50;
    let freight_calc = total_volume*unitFee;
    let freight = (freight_calc<minFee)?minFee:freight_calc;

    // æ€»æˆæœ¬=äº§å“æˆæœ¬+è¿è´¹
    let totalCostWithFreight = totalProductCost+freight;

    // åˆ©æ¶¦ç‡è¡¨
    let refTable = `<table><tr><th>åˆ©æ¶¦ç‡(%)</th><th>æ•°é‡</th><th>å•ä»·(å…ƒ)</th><th>æ€»ä»·(å…ƒ)</th><th>è¿è´¹(å…ƒ)</th><th>å«è¿è´¹æ€»ä»·(å…ƒ)</th><th>æ“ä½œ</th></tr>`;
    for(let rate=20; rate<=60; rate+=5){
        let totalPrice = totalCostWithFreight/(1-rate/100);
        let singlePrice = totalPrice/qty;
        refTable+=`<tr>
        <td>${rate}</td><td>${qty}</td>
        <td>${singlePrice.toFixed(2)}</td>
        <td>${totalPrice.toFixed(2)}</td>
        <td>${freight.toFixed(2)}</td>
        <td>${totalPrice.toFixed(2)}</td>
        <td><button onclick="downloadExcel(${singlePrice},${totalPrice},${freight})">ä¸‹è½½å®¢æˆ·æŠ¥ä»·å•</button></td>
        </tr>`;
    }
    refTable+="</table>";

    lastCalculation={L,W,H,thickness,paint,style,qty,area_m2,weight,volume_single,total_volume,cost_single,unitFee,freight};

    document.getElementById("result").innerHTML=`
         <b>è§„æ ¼ï¼š</b>${L}Ã—${W}Ã—${H} cm<br>
         <b>åšåº¦ï¼š</b>${thickness} mm<br>
         <b>çƒ¤æ¼†ç±»å‹ï¼š</b>${paint} å…ƒ/kg<br>
         <b>æ¬¾å¼ï¼š</b>${style}<br>
         <b>æ•°é‡ï¼š</b>${qty} ä¸ª<br>
         <b>å•ä¸ªé¢ç§¯ï¼š</b>${area_m2.toFixed(3)} ã¡<br>
         <b>å•ä¸ªé‡é‡ï¼š</b>${weight.toFixed(2)} kg<br>
         <b>å•ä¸ªæ–¹æ•°ï¼š</b>${volume_single.toFixed(3)} mÂ³<br>
         <b>æ€»æ–¹æ•°ï¼š</b>${total_volume.toFixed(3)} mÂ³<br>
         <b>å•ä¸ªæˆæœ¬(ä¸å«è¿è´¹)ï¼š</b>${cost_single.toFixed(2)} å…ƒ<br>
         <b>è¿è´¹è¯¦æƒ…ï¼š</b> æ€»æ–¹æ•°(${total_volume.toFixed(3)} mÂ³) Ã— å•æ–¹ä»·æ ¼(${unitFee} å…ƒ/æ–¹) = ${freight.toFixed(2)} å…ƒ<br>
         <div class='subtitle'>ğŸ“Œ è¯·é€‰æ‹©åˆ©æ¶¦ç‡ä¸‹è½½å®¢æˆ·æŠ¥ä»·å•</div>${refTable}`;
}

function downloadExcel(singlePrice,totalPrice,freight){
    if(!lastCalculation){
        alert("è¯·å…ˆè®¡ç®—æŠ¥ä»·ï¼");
        return;
    }
    let wb=XLSX.utils.book_new();
    let ws=XLSX.utils.aoa_to_sheet([
        ["ğŸ¢ å…¬å¸åç§°ï¼šXXXèŠ±ç®±åˆ¶é€ æœ‰é™å…¬å¸"],
        ["ğŸ“… æŠ¥ä»·æ—¥æœŸ", new Date().toLocaleDateString()],
        ["---------------------------------------------"],
        ["å®¢æˆ·æŠ¥ä»·å•"],
        ["äº§å“å‚æ•°", ""],
        ["é•¿åº¦(cm)", lastCalculation.L],
        ["å®½åº¦(cm)", lastCalculation.W],
        ["é«˜åº¦(cm)", lastCalculation.H],
        ["åšåº¦(mm)", lastCalculation.thickness],
        ["çƒ¤æ¼†ç±»å‹(å…ƒ/kg)", lastCalculation.paint],
        ["æ¬¾å¼", lastCalculation.style],
        ["æ•°é‡(ä¸ª)", lastCalculation.qty],
        ["å•ä¸ªé¢ç§¯(ã¡)", lastCalculation.area_m2.toFixed(3)],
        ["å•ä¸ªé‡é‡(kg)", lastCalculation.weight.toFixed(2)],
        ["å•ä¸ªæ–¹æ•°(mÂ³)", lastCalculation.volume_single.toFixed(3)],
        ["æ€»æ–¹æ•°(mÂ³)", lastCalculation.total_volume.toFixed(3)],
        ["å•ä¸ªæˆæœ¬(ä¸å«è¿è´¹)", lastCalculation.cost_single.toFixed(2)],
        ["è¿è´¹è¯¦æƒ…", `æ€»æ–¹æ•°(${lastCalculation.total_volume.toFixed(3)} mÂ³) Ã— å•æ–¹ä»·æ ¼(${lastCalculation.unitFee} å…ƒ/æ–¹) = ${lastCalculation.freight.toFixed(2)} å…ƒ`],
        ["å•ä»·(å…ƒ)", singlePrice.toFixed(2)],
        ["æ€»ä»·(å…ƒ)", totalPrice.toFixed(2)],
        ["å«è¿è´¹æ€»ä»·(å…ƒ)", totalPrice.toFixed(2)],
        ["---------------------------------------------"],
        ["å¤‡æ³¨ï¼šæœ¬æŠ¥ä»·å•ä¸ºå‚è€ƒä»·ï¼Œä¸å«ç¨è´¹åŠå…¶ä»–é™„åŠ è´¹ç”¨ã€‚"]
    ]);
    XLSX.utils.book_append_sheet(wb,ws,"å®¢æˆ·æŠ¥ä»·å•");
    XLSX.writeFile(wb,`å®¢æˆ·æŠ¥ä»·å•_${new Date().getTime()}.xlsx`);
}
</script>
</head>
<body>
<div class="navbar">èŠ±ç®±æ™ºèƒ½æŠ¥ä»·ç³»ç»Ÿï¼ˆä¸´æ—¶è¿è´¹100å…ƒç‰ˆ-ä¿®å¤ï¼‰</div>
<div class="container">
<h2>èŠ±ç®±æˆæœ¬ä¸å®¢æˆ·æŠ¥ä»·è®¡ç®—å™¨</h2>
<label>é•¿åº¦(cm):</label><input type="number" id="length"><br>
<label>å®½åº¦(cm):</label><input type="number" id="width"><br>
<label>é«˜åº¦(cm):</label><input type="number" id="height"><br>
<label>åšåº¦(mm):</label>
<select id="thickness">
<option value="0.7">0.7</option>
<option value="1.0">1.0</option>
<option value="1.2">1.2</option>
</select><br>
<label>çƒ¤æ¼†ç±»å‹:</label>
<select id="paint">
<option value="1.5">é»‘ç™½æ ‡å‡†è‰²(1.5å…ƒ/kg)</option>
<option value="2.5">å½©è‰²çƒ¤æ¼†(2.5å…ƒ/kg)</option>
<option value="3.5">ç‰¹è°ƒè‰²(3.5å…ƒ/kg)</option>
</select><br>
<label>æ¬¾å¼:</label>
<select id="style">
<option value="1">æ¬¾å¼1ï¼ˆæ ‡å‡†é‡é‡ï¼‰</option>
<option value="2">æ¬¾å¼2ï¼ˆ+3kgæº¢ä»·ï¼‰</option>
<option value="3">æ¬¾å¼3ï¼ˆ+5kgæº¢ä»·ï¼‰</option>
</select><br>
<label>æ•°é‡(ä¸ª):</label><input type="number" id="quantity" placeholder="å¦‚ 10"><br>
<button onclick="calcCost()">è®¡ç®—æŠ¥ä»·</button>
<div class="result" id="result"></div>
</div>
</body>
</html>
